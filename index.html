<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Exam Hall Seating Plan (CSV Copyable)</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 40px;
    }
    label, input, textarea, button {
      display: block;
      margin: 10px 0;
    }
    .grid {
      margin-top: 20px;
      display: grid;
      gap: 10px;
      background-color: #f0f0f0;
      padding: 10px;
      border: 1px solid #ccc;
    }
    .seat {
      background-color: #e0ffe0;
      border: 1px solid #aaa;
      padding: 8px;
      text-align: center;
      font-size: 14px;
    }
    textarea#csvOutput {
      width: 100%;
      margin-top: 20px;
      font-family: monospace;
      white-space: pre;
    }
  </style>
</head>
<body>

<h2>Exam Hall Seating Plan (Vertical Snake + Copyable CSV)</h2>

<form id="seatingForm">
  <label for="rows">Number of Rows:</label>
  <input type="number" id="rows" required min="1">

  <label for="cols">Number of Columns:</label>
  <input type="number" id="cols" required min="1">

  <label for="students">Student Names or IDs (one per line, in register order):</label>
  <textarea id="students" rows="10" cols="40" required></textarea>

  <button type="submit">Generate Seating Plan</button>
</form>

<div id="seatingGrid" class="grid"></div>

<h3>CSV Output (Copy and Paste)</h3>
<textarea id="csvOutput" rows="10" readonly></textarea>

<script>
  function getRowLabel(index) {
    return String.fromCharCode(65 + index); // A, B, C, ...
  }

  document.getElementById('seatingForm').addEventListener('submit', function (e) {
    e.preventDefault();

    const rows = parseInt(document.getElementById('rows').value);
    const cols = parseInt(document.getElementById('cols').value);
    const studentsRaw = document.getElementById('students').value.trim();
    const studentList = studentsRaw.split('\n').map(s => s.trim()).filter(s => s);

    const gridData = Array.from({ length: rows }, () => Array(cols).fill("- Empty -"));
    let studentIndex = 0;

    for (let col = 0; col < cols; col++) {
      const down = col % 2 === 0;
      const rowOrder = down ? [...Array(rows).keys()] : [...Array(rows).keys()].reverse();

      for (let row of rowOrder) {
        if (studentIndex < studentList.length) {
          gridData[row][col] = studentList[studentIndex];
          studentIndex++;
        }
      }
    }

    // Render the visual grid
    const grid = document.getElementById('seatingGrid');
    grid.innerHTML = '';
    grid.style.gridTemplateColumns = `repeat(${cols + 1}, auto)`;

    // Header row
    grid.appendChild(document.createElement('div')); // top-left empty cell
    for (let c = 0; c < cols; c++) {
      const label = document.createElement('div');
      label.className = 'seat';
      label.style.backgroundColor = '#d0d0ff';
      label.textContent = c + 1;
      grid.appendChild(label);
    }

    // Rows
    for (let r = 0; r < rows; r++) {
      const rowLabel = document.createElement('div');
      rowLabel.className = 'seat';
      rowLabel.style.backgroundColor = '#d0d0ff';
      rowLabel.textContent = getRowLabel(r);
      grid.appendChild(rowLabel);

      for (let c = 0; c < cols; c++) {
        const seat = document.createElement('div');
        seat.className = 'seat';
        seat.textContent = gridData[r][c];
        grid.appendChild(seat);
      }
    }

    // Build CSV output
    let csvRows = [];
    let header = [""].concat(Array.from({ length: cols }, (_, i) => i + 1));
    csvRows.push(header.join(","));

    for (let r = 0; r < rows; r++) {
      const rowLabel = getRowLabel(r);
      const rowData = [rowLabel].concat(gridData[r]);
      csvRows.push(rowData.join(","));
    }

    document.getElementById('csvOutput').value = csvRows.join("\n");
  });
</script>

</body>
</html>
