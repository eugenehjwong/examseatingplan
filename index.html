<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Exam Hall Seating Plan (Column Breaks)</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 40px;
    }
    label, input, textarea, button {
      display: block;
      margin: 10px 0;
    }
    .grid {
      margin-top: 20px;
      display: grid;
      gap: 10px;
      background-color: #f0f0f0;
      padding: 10px;
      border: 1px solid #ccc;
    }
    .seat {
      background-color: #e0ffe0;
      border: 1px solid #aaa;
      padding: 8px;
      text-align: center;
      font-size: 14px;
    }
    textarea#csvOutput {
      width: 100%;
      margin-top: 20px;
      font-family: monospace;
      white-space: pre;
    }
  </style>
</head>
<body>

<h2>Exam Hall Seating Plan (with Column Breaks)</h2>

<form id="seatingForm">
  <label for="rows">Number of Rows:</label>
  <input type="number" id="rows" required min="1">

  <label for="cols">Number of Columns:</label>
  <input type="number" id="cols" required min="1">

  <label for="students">Student Names or IDs (one per line).  
    Use <code>---</code> to start a new column:</label>
  <textarea id="students" rows="12" cols="50" required></textarea>

  <button type="submit">Generate Seating Plan</button>
</form>

<div id="seatingGrid" class="grid"></div>

<h3>CSV Output (Spaced for Excel)</h3>
<textarea id="csvOutput" rows="12" readonly></textarea>

<script>
  function getRowLabel(index) {
    return String.fromCharCode(65 + index); // A, B, C, ...
  }

  document.getElementById('seatingForm').addEventListener('submit', function (e) {
    e.preventDefault();

    const rows = parseInt(document.getElementById('rows').value);
    const cols = parseInt(document.getElementById('cols').value);
    const input = document.getElementById('students').value.trim();
    const lines = input.split('\n').map(l => l.trim());

    const gridData = Array.from({ length: rows }, () => Array(cols).fill("- Empty -"));

    let col = 0;
    let studentIndex = 0;
    let buffer = [];

    for (let i = 0; i < lines.length; i++) {
      const line = lines[i];

      if (line === "---") {
        // Place the current buffer into the current column
        placeStudentsInColumn(buffer, col, gridData, rows);
        buffer = [];
        col++;
        if (col >= cols) break;
      } else if (line) {
        buffer.push(line);
      }
    }

    // Final buffer (after last group)
    if (buffer.length && col < cols) {
      placeStudentsInColumn(buffer, col, gridData, rows);
    }

    // Render visual grid
    const grid = document.getElementById('seatingGrid');
    grid.innerHTML = '';
    grid.style.gridTemplateColumns = `repeat(${cols + 1}, auto)`;

    // Header row
    grid.appendChild(document.createElement('div'));
    for (let c = 0; c < cols; c++) {
      const label = document.createElement('div');
      label.className = 'seat';
      label.style.backgroundColor = '#d0d0ff';
      label.textContent = c + 1;
      grid.appendChild(label);
    }

    for (let r = 0; r < rows; r++) {
      const rowLabel = document.createElement('div');
      rowLabel.className = 'seat';
      rowLabel.style.backgroundColor = '#d0d0ff';
      rowLabel.textContent = getRowLabel(r);
      grid.appendChild(rowLabel);

      for (let c = 0; c < cols; c++) {
        const seat = document.createElement('div');
        seat.className = 'seat';
        seat.textContent = gridData[r][c];
        grid.appendChild(seat);
      }
    }

    // Create CSV with space between rows and columns
    const csvRows = [];
    const header = [""];
    for (let c = 0; c < cols; c++) {
      header.push((c + 1).toString());
      if (c !== cols - 1) header.push(""); // space between
    }
    csvRows.push(header.join(","));

    for (let r = 0; r < rows; r++) {
      const row = [getRowLabel(r)];
      for (let c = 0; c < cols; c++) {
        row.push(gridData[r][c]);
        if (c !== cols - 1) row.push("");
      }
      csvRows.push(row.join(","));
      if (r !== rows - 1) csvRows.push(""); // blank row
    }

    document.getElementById('csvOutput').value = csvRows.join("\n");
  });

  function placeStudentsInColumn(studentList, colIndex, grid, maxRows) {
    const down = colIndex % 2 === 0;
    const order = down ? [...Array(maxRows).keys()] : [...Array(maxRows).keys()].reverse();
    let idx = 0;

    for (let r of order) {
      if (idx >= studentList.length) break;
      grid[r][colIndex] = studentList[idx];
      idx++;
    }
  }
</script>

</body>
</html>
